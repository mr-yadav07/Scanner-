<!doctype html>

<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Face Detection Alarm</title>
<style>
  body,html {
    margin:0; padding:0; height:100%; display:flex; flex-direction:column;
    align-items:center; justify-content:center; font-family: Arial,sans-serif;
    background:#000; color:#0f0;
  }
  video, canvas {
    max-width: 100vw;
    border-radius: 8px;
    border: 3px solid #0f0;
    background:#000;
  }
  video {
    max-height: 70vh;
  }
  #faceCount {
    margin-top: 1em;
    font-size: 1.5em;
  }
</style>
</head>
<body>
  <video id="video" autoplay playsinline></video>
  <canvas id="overlay"></canvas>
  <div id="faceCount">Faces detected: 0</div>
  <audio id="alarm" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>
<script type="module">
import * as faceapi from 'https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/+esm';
(async function(){
  const video = document.getElementById('video');
  const overlay = document.getElementById('overlay');
  const alarm = document.getElementById('alarm');
  const faceCount = document.getElementById('faceCount');
  try {
    const stream = await navigator.mediaDevices.getUserMedia({video: {facingMode: 'user'}});
    video.srcObject = stream;
  } catch(e) {
    alert('Camera access denied or not available.');
    return;
  }
  await faceapi.nets.tinyFaceDetector.loadFromUri('https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/weights');
  await faceapi.nets.faceLandmark68Net.loadFromUri('https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/weights');const options = new faceapi.TinyFaceDetectorOptions(); const ctx = overlay.getContext('2d'); let alarmPlaying = false;

video.addEventListener('play', () => { overlay.width = video.videoWidth; overlay.height = video.videoHeight; function detect(){ faceapi.detectAllFaces(video, options).withFaceLandmarks().then(detections=>{ ctx.clearRect(0,0,overlay.width,overlay.height); faceapi.draw.drawDetections(overlay, detections); faceapi.draw.drawFaceLandmarks(overlay, detections); faceCount.textContent = Faces detected: ${detections.length}; if(detections.length>0){ if(!alarmPlaying){ alarm.play().catch(()=>{}); alarmPlaying = true; } } else { alarm.pause(); alarm.currentTime = 0; alarmPlaying = false; } requestAnimationFrame(detect); }); } detect(); }); })(); </script>

</body>
</html>
